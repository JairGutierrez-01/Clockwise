<!doctype html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Forgot Password - ClockWise</title>

    <!-- Einheitliches Styling wie bei Login/Register -->
    <link
      rel="stylesheet"
      href="{{ url_for('static', filename='homepage.css') }}"
    />
    <link
      rel="stylesheet"
      href="{{ url_for('static', filename='navbar.css') }}"
    />
    <link
      rel="stylesheet"
      href="{{ url_for('static', filename='forgotpassword.css') }}"
    />
  </head>

  <body class="dark-mode">
    <!-- Navbar -->
    <nav class="navbar navbar-login">
      <div class="logo">ClockWise</div>
      <div class="nav-items">
        <a href="{{ url_for('home') }}">Home</a>
      </div>
    </nav>

    <!-- Forgot Password Box -->
    <div class="login-container">
      <form
        class="login-box"
        method="POST"
        action="{{ url_for('auth.forgot_password') }}"
      >
        <!-- Hinweistext -->
        <p class="forgot-instruction">
          Please enter your email address. You will receive a link to reset your
          password.
        </p>

        <!-- E-Mail-Feld -->
        <input type="email" name="email" placeholder="Email Address" required />

        <!-- Senden-Button -->
        <button type="submit">Send Email</button>

        <!-- Resend-Link -->
        <!-- <div class="resend-link">
          <a href="#" onclick="resendEmail()" class="link-button"
            >Resend reset email</a
          > -->
        <div class="resend-link">
          <a href="#" onclick="resendEmail(event)" class="link-button"
            >Resend reset email</a
          >
        </div>
      </form>
    </div>
  </body>
</html>
<script>
  function resendEmail(event) {
    event.preventDefault();

    const email = document.querySelector('input[name="email"]').value;

    if (!email) {
      alert("Please enter your email address first.");
      return;
    }

    fetch("/auth/resend-reset-email", {
      method: "POST",
      headers: {
        "Content-Type": "application/json",
      },
      body: JSON.stringify({ email: email }),
    })
      .then((res) => res.json())
      .then((data) => {
        if (data.success) {
          alert(data.message);
        } else {
          alert(data.error);
        }
      })
      .catch((err) => {
        console.error("Error:", err);
        alert("Something went wrong.");
      });
  }
</script>
