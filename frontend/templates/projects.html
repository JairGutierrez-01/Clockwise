<!doctype html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Project Management – ClockWise</title>
    <link
      rel="stylesheet"
      href="{{ url_for('static', filename='navbar.css') }}"
    />

    <link
      rel="stylesheet"
      href="{{ url_for('static', filename='projects.css') }}"
    />
  </head>
  <body class="dark-mode">
    {% include 'navbar.html' %}
    <div class="project-page">
      <!-- Header with Filter & Create Button -->
      <header class="project-header">
        <h1>Projects</h1>
        <div id="filter-controls">
          <button data-filter="all" class="active">All</button>
          <button data-filter="SoloProject">Solo Projects</button>
          <button data-filter="TeamProject">Team Projects</button>
          <button data-filter="unassigned">Unassigned Tasks</button>
          <button data-filter="alltasks">All Tasks</button>
        </div>
        <button id="create-project-btn" type="button">＋ New Project</button>
      </header>

      <!-- List of Existing Projects -->
      <section id="project-list" class="project-list">
        <!-- Remember I've put the layout of the card in the JS code -->
      </section>

      <!-- Project Creation / Edit Modal -->
      <div id="project-form-modal" class="modal hidden">
        <form id="project-form" class="project-form">
          <h2 id="form-title">New Project</h2>

          <label for="project-name">Name *</label>
          <input type="text" id="project-name" name="name" required />

          <label for="project-description">Description</label>
          <textarea id="project-description" name="description"></textarea>

          <label for="project-type">Type *</label>
          <select id="project-type" name="type">
            <option value="SoloProject">SoloProject</option>
            <option value="TeamProject">TeamProject</option>
          </select>

          <label for="project-time-limit">Time Limit (hours) *</label>
          <input
            type="number"
            id="project-time-limit"
            name="time_limit_hours"
            min="0"
            value="0"
            required
          />

          <label for="project-due-date">Due Date</label>
          <input type="date" id="project-due-date" name="due_date" />

          <div class="form-actions">
            <button type="submit" id="save-project-btn">Save</button>
            <button type="button" id="cancel-project-btn">Cancel</button>
          </div>
        </form>
      </div>

      <!-- Detail View for a Single Project -->
      <section id="project-detail" class="project-detail hidden">
        <header class="project-detail__header">
          <h2 id="detail-name">Project Name</h2>
          <div class="project-detail__actions">
            <button id="edit-project-btn">Edit</button>
            <button id="delete-project-btn">Delete</button>
          </div>
        </header>
        <dl class="project-detail__info">
          <dt>Description:</dt>
          <dd id="detail-description">…</dd>
          <dt>Type:</dt>
          <dd id="detail-type">SoloProject</dd>
          <dt>Time Limit:</dt>
          <dd id="detail-time-limit">10 h</dd>
          <p>
            <strong>Spent Time:</strong> <span id="detail-current-hours"></span>
          </p>
          <dt>Due Date:</dt>
          <dd id="detail-due-date">2025-06-01</dd>
        </dl>

        <!-- Task Management Within This Project -->
        <div class="tasks-section">
          <header class="tasks-header">
            <h3>Tasks</h3>
            <button id="create-task-btn" type="button" class="btn-secondary">
              ＋ Add Task
            </button>
          </header>
          <ul id="task-list" class="task-list">
            <!-- Remember: JS will inject each task-item here -->
          </ul>
        </div>
      </section>
    </div>

    <!-- Task Creation Modal -->
    <div id="task-form-modal" class="modal hidden">
      <form id="task-form" class="project-form">
        <h2 id="task-form-title">New Task</h2>

        <label for="task-name">Name *</label>
        <input type="text" id="task-name" name="name" required />

        <label for="task-description">Description</label>
        <textarea id="task-description" name="description"></textarea>

        <label for="task-category">Category</label>
        <select id="task-category" name="category_id">
          <option value="">-- Select Category --</option>
          <option value="1">Hausarbeit</option>
          <option value="2">Prüfung</option>
          <option value="3">Wiederholung</option>
        </select>

        <label for="task-project">Project</label>
        <select id="task-project" name="project_id">
          <option value="">-- Select Project --</option>
        </select>

        <label for="task-due-date">Due Date</label>
        <input type="date" id="task-due-date" name="due_date" />

        <label for="task-status">Status</label>
        <select id="task-status" name="status" required>
          <option value="todo">Not Started</option>
          <option value="in_progress">In Progress</option>
          <option value="done">Done</option>
        </select>

        <div class="form-actions">
          <button type="submit" id="save-task-btn">Save</button>
          <button type="button" id="cancel-task-btn">Cancel</button>
        </div>
      </form>
    </div>

    <!-- Include theme toggle and projects scripts -->
    <script src="{{ url_for('static', filename='js/theme.js') }}"></script>
    <script src="{{ url_for('static', filename='js/projects.js') }}"></script>
    {% if user_logged_in %}
    <script src="{{ url_for('static', filename='js/base.js') }}"></script>
    {% endif %}
  </body>
</html>
