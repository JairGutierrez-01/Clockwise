<!doctype html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>My Profile - ClockWise</title>

    <link rel="stylesheet" href="{{ url_for('static', filename='navbar.css') }}">
    <link rel="stylesheet" href="{{ url_for('static', filename='profile.css') }}">
  </head>

  <body class="dark-mode">
    {% include 'navbar.html' %}

    <div class="profile-container">
      <div class="profile-card">
        <img
          src="{{ user.profile_picture or url_for('static', filename='images/default_avatar.png') }}"
          alt="Profile Picture"
          class="profile-picture"
        />

        <h2>{{ user.first_name }} {{ user.last_name }}</h2>
        <p>@{{ user.username }}</p>
        <p>Email: {{ user.email }}</p>
        <p>Joined: {{ user.created_at.strftime('%Y-%m-%d') }}</p>
        <p>Last Active: {{ user.last_active.strftime('%Y-%m-%d %H:%M') }}</p>

        <div class="teams">
          <h3>Teams</h3>
          <ul>
            {% for ut in user.teams %}
              <li>{{ ut.team.name }} ({{ ut.role }})</li>
            {% else %}
              <li>No team memberships</li>
            {% endfor %}
          </ul>
        </div>

        <div class="projects">
          <h3>My Projects</h3>
          <ul>
            {% for project in user.project %}
              <li>{{ project.name }} â€“ {{ project.type.value }}</li>
            {% else %}
              <li>No projects found</li>
            {% endfor %}
          </ul>
        </div>

        <hr>

        <div class="edit-profile">
          <h3>Edit Profile</h3>
          <form method="POST" action="{{ url_for('auth.update_profile') }}">
            <label for="first_name">First Name:</label>
            <input type="text" id="first_name" name="first_name" value="{{ user.first_name }}" required>

            <label for="last_name">Last Name:</label>
            <input type="text" id="last_name" name="last_name" value="{{ user.last_name }}" required>

            <label for="username">Username:</label>
            <input type="text" id="username" name="username" value="{{ user.username }}" required>

            <label for="password">New Password:</label>
            <input type="password" id="password" name="password" placeholder="Leave blank to keep current password">

            <button type="submit">Update Profile</button>
          </form>
        </div>

        <hr>

        <div class="delete-profile">
          <h3>Delete Profile</h3>
          <form method="POST" action="{{ url_for('auth.delete_profile') }}" onsubmit="return confirm('Are you sure you want to delete your account? This cannot be undone!');">
            <button type="submit" class="danger">Delete My Account</button>
          </form>
        </div>

      </div>
    </div>

    <script src="{{ url_for('static', filename='theme.js') }}"></script>
  </body>
</html>

